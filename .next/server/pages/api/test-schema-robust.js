"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/test-schema-robust";
exports.ids = ["pages/api/test-schema-robust"];
exports.modules = {

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftest-schema-robust&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ftest-schema-robust.ts&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftest-schema-robust&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ftest-schema-robust.ts&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_test_schema_robust_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/test-schema-robust.ts */ \"(api-node)/./pages/api/test-schema-robust.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_test_schema_robust_ts__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_test_schema_robust_ts__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/test-schema-robust\",\n        pathname: \"/api/test-schema-robust\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_test_schema_robust_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGdGVzdC1zY2hlbWEtcm9idXN0JnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlMkZhcGklMkZ0ZXN0LXNjaGVtYS1yb2J1c3QudHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ0U7QUFDMUQ7QUFDOEQ7QUFDOUQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLDZEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyw2REFBUTtBQUNwQztBQUNPLHdCQUF3Qix5R0FBbUI7QUFDbEQ7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzL2FwaS90ZXN0LXNjaGVtYS1yb2J1c3QudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgJ2RlZmF1bHQnKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsICdjb25maWcnKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3Rlc3Qtc2NoZW1hLXJvYnVzdFwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3Rlc3Qtc2NoZW1hLXJvYnVzdFwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6ICcnLFxuICAgICAgICBmaWxlbmFtZTogJydcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftest-schema-robust&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ftest-schema-robust.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./pages/api/test-schema-robust.ts":
/*!*****************************************!*\
  !*** ./pages/api/test-schema-robust.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(process.env.SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);\nasync function handler(req, res) {\n    try {\n        const results = {\n            pipeline_status: 'success',\n            steps: {\n                schema_fetch: null,\n                client_generation: null,\n                end_to_end_test: null\n            },\n            recommendations: []\n        };\n        // Step 1: Test Schema Fetching\n        console.log('ðŸ” Testing schema fetch capabilities...');\n        try {\n            const { data: tables, error } = await supabase.rpc('get_all_tables');\n            if (error) throw error;\n            results.steps.schema_fetch = {\n                status: 'success',\n                tables_count: tables?.length || 0,\n                sample_tables: tables?.slice(0, 5) || [],\n                message: `Found ${tables?.length || 0} tables in database`\n            };\n            // Test column fetching for a few tables\n            if (tables && tables.length > 0) {\n                const sampleTable = tables[0];\n                const { data: columns, error: colError } = await supabase.rpc('get_table_columns', {\n                    table_name_input: sampleTable\n                });\n                results.steps.schema_fetch.sample_schema = {\n                    table: sampleTable,\n                    columns_count: columns?.length || 0,\n                    columns: columns?.slice(0, 3) || []\n                };\n            }\n        } catch (error) {\n            results.steps.schema_fetch = {\n                status: 'error',\n                error: error.message,\n                message: 'Schema fetch failed - check RPC functions'\n            };\n            results.recommendations.push('Run the SQL functions in Supabase SQL Editor');\n        }\n        // Step 2: Test Direct Client Operations\n        console.log('ðŸ”§ Testing direct client operations...');\n        try {\n            const testOperations = [];\n            const testTables = [\n                'users',\n                'announcements',\n                'classes'\n            ];\n            for (const tableName of testTables){\n                try {\n                    // Test basic CRUD operations\n                    const selectResult = await supabase.from(tableName).select('*').limit(2);\n                    const countResult = await supabase.from(tableName).select('*', {\n                        count: 'exact',\n                        head: true\n                    });\n                    testOperations.push({\n                        table: tableName,\n                        select_status: selectResult.error ? 'error' : 'success',\n                        count_status: countResult.error ? 'error' : 'success',\n                        record_count: countResult.count || 0,\n                        sample_data: selectResult.data?.length || 0,\n                        errors: [\n                            selectResult.error?.message,\n                            countResult.error?.message\n                        ].filter(Boolean)\n                    });\n                } catch (tableError) {\n                    testOperations.push({\n                        table: tableName,\n                        status: 'error',\n                        error: tableError.message\n                    });\n                }\n            }\n            results.steps.client_generation = {\n                status: 'success',\n                message: 'Direct Supabase clients working',\n                operations_tested: testOperations,\n                working_tables: testOperations.filter((op)=>op.select_status === 'success').length\n            };\n        } catch (error) {\n            results.steps.client_generation = {\n                status: 'error',\n                error: error.message\n            };\n        }\n        // Step 3: End-to-End Workflow Test\n        console.log('ðŸš€ Testing end-to-end workflow...');\n        try {\n            // Simulate the full workflow\n            const workflow = {\n                schema_available: !!results.steps.schema_fetch?.status === 'success',\n                clients_working: !!results.steps.client_generation?.status === 'success',\n                generated_files_path: 'lib/supabase/_generated/clients/',\n                ready_for_production: false\n            };\n            workflow.ready_for_production = workflow.schema_available && workflow.clients_working;\n            results.steps.end_to_end_test = {\n                status: workflow.ready_for_production ? 'success' : 'needs_attention',\n                workflow,\n                message: workflow.ready_for_production ? 'Pipeline is ready for production use' : 'Pipeline needs some fixes before production'\n            };\n            // Add recommendations\n            if (!workflow.schema_available) {\n                results.recommendations.push('Fix schema fetching - ensure RPC functions are created');\n            }\n            if (!workflow.clients_working) {\n                results.recommendations.push('Fix client generation - check import paths and file structure');\n            }\n            if (workflow.ready_for_production) {\n                results.recommendations.push('âœ… Ready to run: npx tsx schema/index.ts && npx tsx schema/copy-to-edits.mts && npx tsx schema/generate-clients-from-edits.mts');\n            }\n        } catch (error) {\n            results.steps.end_to_end_test = {\n                status: 'error',\n                error: error.message\n            };\n        }\n        // Overall pipeline status\n        const allStepsSuccess = Object.values(results.steps).every((step)=>step?.status === 'success');\n        results.pipeline_status = allStepsSuccess ? 'ready' : 'needs_fixes';\n        return res.status(200).json({\n            message: 'Schema pipeline comprehensive test completed',\n            timestamp: new Date().toISOString(),\n            overall_status: results.pipeline_status,\n            results,\n            next_steps: results.recommendations\n        });\n    } catch (error) {\n        console.error('Robust pipeline test error:', error);\n        const errorMessage = error instanceof Error ? error.message : 'Unknown error occurred';\n        return res.status(500).json({\n            error: errorMessage,\n            message: 'Pipeline test failed completely'\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3BhZ2VzL2FwaS90ZXN0LXNjaGVtYS1yb2J1c3QudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ3FEO0FBRXJELE1BQU1DLFdBQVdELG1FQUFZQSxDQUMzQkUsUUFBUUMsR0FBRyxDQUFDQyxZQUFZLEVBQ3hCRixRQUFRQyxHQUFHLENBQUNFLHlCQUF5QjtBQUd4QixlQUFlQyxRQUFRQyxHQUFtQixFQUFFQyxHQUFvQjtJQUM3RSxJQUFJO1FBQ0YsTUFBTUMsVUFBZTtZQUNuQkMsaUJBQWlCO1lBQ2pCQyxPQUFPO2dCQUNMQyxjQUFjO2dCQUNkQyxtQkFBbUI7Z0JBQ25CQyxpQkFBaUI7WUFDbkI7WUFDQUMsaUJBQWlCLEVBQUU7UUFDckI7UUFFQSwrQkFBK0I7UUFDL0JDLFFBQVFDLEdBQUcsQ0FBQztRQUNaLElBQUk7WUFDRixNQUFNLEVBQUVDLE1BQU1DLE1BQU0sRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTW5CLFNBQVNvQixHQUFHLENBQUM7WUFFbkQsSUFBSUQsT0FBTyxNQUFNQTtZQUVqQlgsUUFBUUUsS0FBSyxDQUFDQyxZQUFZLEdBQUc7Z0JBQzNCVSxRQUFRO2dCQUNSQyxjQUFjSixRQUFRSyxVQUFVO2dCQUNoQ0MsZUFBZU4sUUFBUU8sTUFBTSxHQUFHLE1BQU0sRUFBRTtnQkFDeENDLFNBQVMsQ0FBQyxNQUFNLEVBQUVSLFFBQVFLLFVBQVUsRUFBRSxtQkFBbUIsQ0FBQztZQUM1RDtZQUVBLHdDQUF3QztZQUN4QyxJQUFJTCxVQUFVQSxPQUFPSyxNQUFNLEdBQUcsR0FBRztnQkFDL0IsTUFBTUksY0FBY1QsTUFBTSxDQUFDLEVBQUU7Z0JBQzdCLE1BQU0sRUFBRUQsTUFBTVcsT0FBTyxFQUFFVCxPQUFPVSxRQUFRLEVBQUUsR0FBRyxNQUFNN0IsU0FBU29CLEdBQUcsQ0FBQyxxQkFBcUI7b0JBQ2pGVSxrQkFBa0JIO2dCQUNwQjtnQkFFQW5CLFFBQVFFLEtBQUssQ0FBQ0MsWUFBWSxDQUFDb0IsYUFBYSxHQUFHO29CQUN6Q0Ms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Qy9CO1lBQ0EsSUFBSXNCLFNBQVNJLG9CQUFvQixFQUFFO2dCQUNqQ3BELFFBQVFNLGVBQWUsQ0FBQ29CLElBQUksQ0FBQztZQUMvQjtRQUVGLEVBQUUsT0FBT2YsT0FBWTtZQUNuQlgsUUFBUUUsS0FBSyxDQUFDRyxlQUFlLEdBQUc7Z0JBQzlCUSxRQUFRO2dCQUNSRixPQUFPQSxNQUFNTyxPQUFPO1lBQ3RCO1FBQ0Y7UUFFQSwwQkFBMEI7UUFDMUIsTUFBTW1DLGtCQUFrQkMsT0FBT0MsTUFBTSxDQUFDdkQsUUFBUUUsS0FBSyxFQUFFc0QsS0FBSyxDQUFDQyxDQUFBQSxPQUFRQSxNQUFNNUMsV0FBVztRQUNwRmIsUUFBUUMsZUFBZSxHQUFHb0Qsa0JBQWtCLFVBQVU7UUFFdEQsT0FBT3RELElBQUljLE1BQU0sQ0FBQyxLQUFLNkMsSUFBSSxDQUFDO1lBQzFCeEMsU0FBUztZQUNUeUMsV0FBVyxJQUFJQyxPQUFPQyxXQUFXO1lBQ2pDQyxnQkFBZ0I5RCxRQUFRQyxlQUFlO1lBQ3ZDRDtZQUNBK0QsWUFBWS9ELFFBQVFNLGVBQWU7UUFDckM7SUFFRixFQUFFLE9BQU9LLE9BQWdCO1FBQ3ZCSixRQUFRSSxLQUFLLENBQUMsK0JBQStCQTtRQUM3QyxNQUFNcUQsZUFBZXJELGlCQUFpQnNELFFBQVF0RCxNQUFNTyxPQUFPLEdBQUc7UUFDOUQsT0FBT25CLElBQUljLE1BQU0sQ0FBQyxLQUFLNkMsSUFBSSxDQUFDO1lBQzFCL0MsT0FBT3FEO1lBQ1A5QyxTQUFTO1FBQ1g7SUFDRjtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvcmFqYXRkaGFuZGEvc2FuZGJveC9zYW5kYm94LWFwcC9zYW5kYm94LWFwcC0xL3BhZ2VzL2FwaS90ZXN0LXNjaGVtYS1yb2J1c3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnO1xuXG5jb25zdCBzdXBhYmFzZSA9IGNyZWF0ZUNsaWVudChcbiAgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfVVJMISxcbiAgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSFcbik7XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHRzOiBhbnkgPSB7XG4gICAgICBwaXBlbGluZV9zdGF0dXM6ICdzdWNjZXNzJyxcbiAgICAgIHN0ZXBzOiB7XG4gICAgICAgIHNjaGVtYV9mZXRjaDogbnVsbCxcbiAgICAgICAgY2xpZW50X2dlbmVyYXRpb246IG51bGwsXG4gICAgICAgIGVuZF90b19lbmRfdGVzdDogbnVsbFxuICAgICAgfSxcbiAgICAgIHJlY29tbWVuZGF0aW9uczogW11cbiAgICB9O1xuXG4gICAgLy8gU3RlcCAxOiBUZXN0IFNjaGVtYSBGZXRjaGluZ1xuICAgIGNvbnNvbGUubG9nKCfwn5SNIFRlc3Rpbmcgc2NoZW1hIGZldGNoIGNhcGFiaWxpdGllcy4uLicpO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGRhdGE6IHRhYmxlcywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLnJwYygnZ2V0X2FsbF90YWJsZXMnKTtcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcbiAgICAgIFxuICAgICAgcmVzdWx0cy5zdGVwcy5zY2hlbWFfZmV0Y2ggPSB7XG4gICAgICAgIHN0YXR1czogJ3N1Y2Nlc3MnLFxuICAgICAgICB0YWJsZXNfY291bnQ6IHRhYmxlcz8ubGVuZ3RoIHx8IDAsXG4gICAgICAgIHNhbXBsZV90YWJsZXM6IHRhYmxlcz8uc2xpY2UoMCwgNSkgfHwgW10sXG4gICAgICAgIG1lc3NhZ2U6IGBGb3VuZCAke3RhYmxlcz8ubGVuZ3RoIHx8IDB9IHRhYmxlcyBpbiBkYXRhYmFzZWBcbiAgICAgIH07XG5cbiAgICAgIC8vIFRlc3QgY29sdW1uIGZldGNoaW5nIGZvciBhIGZldyB0YWJsZXNcbiAgICAgIGlmICh0YWJsZXMgJiYgdGFibGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3Qgc2FtcGxlVGFibGUgPSB0YWJsZXNbMF07XG4gICAgICAgIGNvbnN0IHsgZGF0YTogY29sdW1ucywgZXJyb3I6IGNvbEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5ycGMoJ2dldF90YWJsZV9jb2x1bW5zJywge1xuICAgICAgICAgIHRhYmxlX25hbWVfaW5wdXQ6IHNhbXBsZVRhYmxlXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgcmVzdWx0cy5zdGVwcy5zY2hlbWFfZmV0Y2guc2FtcGxlX3NjaGVtYSA9IHtcbiAgICAgICAgICB0YWJsZTogc2FtcGxlVGFibGUsXG4gICAgICAgICAgY29sdW1uc19jb3VudDogY29sdW1ucz8ubGVuZ3RoIHx8IDAsXG4gICAgICAgICAgY29sdW1uczogY29sdW1ucz8uc2xpY2UoMCwgMykgfHwgW11cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICByZXN1bHRzLnN0ZXBzLnNjaGVtYV9mZXRjaCA9IHtcbiAgICAgICAgc3RhdHVzOiAnZXJyb3InLFxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgbWVzc2FnZTogJ1NjaGVtYSBmZXRjaCBmYWlsZWQgLSBjaGVjayBSUEMgZnVuY3Rpb25zJ1xuICAgICAgfTtcbiAgICAgIHJlc3VsdHMucmVjb21tZW5kYXRpb25zLnB1c2goJ1J1biB0aGUgU1FMIGZ1bmN0aW9ucyBpbiBTdXBhYmFzZSBTUUwgRWRpdG9yJyk7XG4gICAgfVxuXG4gICAgLy8gU3RlcCAyOiBUZXN0IERpcmVjdCBDbGllbnQgT3BlcmF0aW9uc1xuICAgIGNvbnNvbGUubG9nKCfwn5SnIFRlc3RpbmcgZGlyZWN0IGNsaWVudCBvcGVyYXRpb25zLi4uJyk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRlc3RPcGVyYXRpb25zID0gW107XG4gICAgICBjb25zdCB0ZXN0VGFibGVzID0gWyd1c2VycycsICdhbm5vdW5jZW1lbnRzJywgJ2NsYXNzZXMnXTtcbiAgICAgIFxuICAgICAgZm9yIChjb25zdCB0YWJsZU5hbWUgb2YgdGVzdFRhYmxlcykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIC8vIFRlc3QgYmFzaWMgQ1JVRCBvcGVyYXRpb25zXG4gICAgICAgICAgY29uc3Qgc2VsZWN0UmVzdWx0ID0gYXdhaXQgc3VwYWJhc2UuZnJvbSh0YWJsZU5hbWUpLnNlbGVjdCgnKicpLmxpbWl0KDIpO1xuICAgICAgICAgIGNvbnN0IGNvdW50UmVzdWx0ID0gYXdhaXQgc3VwYWJhc2UuZnJvbSh0YWJsZU5hbWUpLnNlbGVjdCgnKicsIHsgY291bnQ6ICdleGFjdCcsIGhlYWQ6IHRydWUgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgdGVzdE9wZXJhdGlvbnMucHVzaCh7XG4gICAgICAgICAgICB0YWJsZTogdGFibGVOYW1lLFxuICAgICAgICAgICAgc2VsZWN0X3N0YXR1czogc2VsZWN0UmVzdWx0LmVycm9yID8gJ2Vycm9yJyA6ICdzdWNjZXNzJyxcbiAgICAgICAgICAgIGNvdW50X3N0YXR1czogY291bnRSZXN1bHQuZXJyb3IgPyAnZXJyb3InIDogJ3N1Y2Nlc3MnLFxuICAgICAgICAgICAgcmVjb3JkX2NvdW50OiBjb3VudFJlc3VsdC5jb3VudCB8fCAwLFxuICAgICAgICAgICAgc2FtcGxlX2RhdGE6IHNlbGVjdFJlc3VsdC5kYXRhPy5sZW5ndGggfHwgMCxcbiAgICAgICAgICAgIGVycm9yczogW3NlbGVjdFJlc3VsdC5lcnJvcj8ubWVzc2FnZSwgY291bnRSZXN1bHQuZXJyb3I/Lm1lc3NhZ2VdLmZpbHRlcihCb29sZWFuKVxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoICh0YWJsZUVycm9yOiBhbnkpIHtcbiAgICAgICAgICB0ZXN0T3BlcmF0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgIHRhYmxlOiB0YWJsZU5hbWUsXG4gICAgICAgICAgICBzdGF0dXM6ICdlcnJvcicsXG4gICAgICAgICAgICBlcnJvcjogdGFibGVFcnJvci5tZXNzYWdlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmVzdWx0cy5zdGVwcy5jbGllbnRfZ2VuZXJhdGlvbiA9IHtcbiAgICAgICAgc3RhdHVzOiAnc3VjY2VzcycsXG4gICAgICAgIG1lc3NhZ2U6ICdEaXJlY3QgU3VwYWJhc2UgY2xpZW50cyB3b3JraW5nJyxcbiAgICAgICAgb3BlcmF0aW9uc190ZXN0ZWQ6IHRlc3RPcGVyYXRpb25zLFxuICAgICAgICB3b3JraW5nX3RhYmxlczogdGVzdE9wZXJhdGlvbnMuZmlsdGVyKG9wID0+IG9wLnNlbGVjdF9zdGF0dXMgPT09ICdzdWNjZXNzJykubGVuZ3RoXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIHJlc3VsdHMuc3RlcHMuY2xpZW50X2dlbmVyYXRpb24gPSB7XG4gICAgICAgIHN0YXR1czogJ2Vycm9yJyxcbiAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2VcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gU3RlcCAzOiBFbmQtdG8tRW5kIFdvcmtmbG93IFRlc3RcbiAgICBjb25zb2xlLmxvZygn8J+agCBUZXN0aW5nIGVuZC10by1lbmQgd29ya2Zsb3cuLi4nKTtcbiAgICB0cnkge1xuICAgICAgLy8gU2ltdWxhdGUgdGhlIGZ1bGwgd29ya2Zsb3dcbiAgICAgIGNvbnN0IHdvcmtmbG93ID0ge1xuICAgICAgICBzY2hlbWFfYXZhaWxhYmxlOiAhIXJlc3VsdHMuc3RlcHMuc2NoZW1hX2ZldGNoPy5zdGF0dXMgPT09ICdzdWNjZXNzJyxcbiAgICAgICAgY2xpZW50c193b3JraW5nOiAhIXJlc3VsdHMuc3RlcHMuY2xpZW50X2dlbmVyYXRpb24/LnN0YXR1cyA9PT0gJ3N1Y2Nlc3MnLFxuICAgICAgICBnZW5lcmF0ZWRfZmlsZXNfcGF0aDogJ2xpYi9zdXBhYmFzZS9fZ2VuZXJhdGVkL2NsaWVudHMvJyxcbiAgICAgICAgcmVhZHlfZm9yX3Byb2R1Y3Rpb246IGZhbHNlXG4gICAgICB9O1xuICAgICAgXG4gICAgICB3b3JrZmxvdy5yZWFkeV9mb3JfcHJvZHVjdGlvbiA9IHdvcmtmbG93LnNjaGVtYV9hdmFpbGFibGUgJiYgd29ya2Zsb3cuY2xpZW50c193b3JraW5nO1xuICAgICAgXG4gICAgICByZXN1bHRzLnN0ZXBzLmVuZF90b19lbmRfdGVzdCA9IHtcbiAgICAgICAgc3RhdHVzOiB3b3JrZmxvdy5yZWFkeV9mb3JfcHJvZHVjdGlvbiA/ICdzdWNjZXNzJyA6ICduZWVkc19hdHRlbnRpb24nLFxuICAgICAgICB3b3JrZmxvdyxcbiAgICAgICAgbWVzc2FnZTogd29ya2Zsb3cucmVhZHlfZm9yX3Byb2R1Y3Rpb24gXG4gICAgICAgICAgPyAnUGlwZWxpbmUgaXMgcmVhZHkgZm9yIHByb2R1Y3Rpb24gdXNlJyBcbiAgICAgICAgICA6ICdQaXBlbGluZSBuZWVkcyBzb21lIGZpeGVzIGJlZm9yZSBwcm9kdWN0aW9uJ1xuICAgICAgfTtcbiAgICAgIFxuICAgICAgLy8gQWRkIHJlY29tbWVuZGF0aW9uc1xuICAgICAgaWYgKCF3b3JrZmxvdy5zY2hlbWFfYXZhaWxhYmxlKSB7XG4gICAgICAgIHJlc3VsdHMucmVjb21tZW5kYXRpb25zLnB1c2goJ0ZpeCBzY2hlbWEgZmV0Y2hpbmcgLSBlbnN1cmUgUlBDIGZ1bmN0aW9ucyBhcmUgY3JlYXRlZCcpO1xuICAgICAgfVxuICAgICAgaWYgKCF3b3JrZmxvdy5jbGllbnRzX3dvcmtpbmcpIHtcbiAgICAgICAgcmVzdWx0cy5yZWNvbW1lbmRhdGlvbnMucHVzaCgnRml4IGNsaWVudCBnZW5lcmF0aW9uIC0gY2hlY2sgaW1wb3J0IHBhdGhzIGFuZCBmaWxlIHN0cnVjdHVyZScpO1xuICAgICAgfVxuICAgICAgaWYgKHdvcmtmbG93LnJlYWR5X2Zvcl9wcm9kdWN0aW9uKSB7XG4gICAgICAgIHJlc3VsdHMucmVjb21tZW5kYXRpb25zLnB1c2goJ+KchSBSZWFkeSB0byBydW46IG5weCB0c3ggc2NoZW1hL2luZGV4LnRzICYmIG5weCB0c3ggc2NoZW1hL2NvcHktdG8tZWRpdHMubXRzICYmIG5weCB0c3ggc2NoZW1hL2dlbmVyYXRlLWNsaWVudHMtZnJvbS1lZGl0cy5tdHMnKTtcbiAgICAgIH1cbiAgICAgIFxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIHJlc3VsdHMuc3RlcHMuZW5kX3RvX2VuZF90ZXN0ID0ge1xuICAgICAgICBzdGF0dXM6ICdlcnJvcicsXG4gICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIE92ZXJhbGwgcGlwZWxpbmUgc3RhdHVzXG4gICAgY29uc3QgYWxsU3RlcHNTdWNjZXNzID0gT2JqZWN0LnZhbHVlcyhyZXN1bHRzLnN0ZXBzKS5ldmVyeShzdGVwID0+IHN0ZXA/LnN0YXR1cyA9PT0gJ3N1Y2Nlc3MnKTtcbiAgICByZXN1bHRzLnBpcGVsaW5lX3N0YXR1cyA9IGFsbFN0ZXBzU3VjY2VzcyA/ICdyZWFkeScgOiAnbmVlZHNfZml4ZXMnO1xuXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgIG1lc3NhZ2U6ICdTY2hlbWEgcGlwZWxpbmUgY29tcHJlaGVuc2l2ZSB0ZXN0IGNvbXBsZXRlZCcsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIG92ZXJhbGxfc3RhdHVzOiByZXN1bHRzLnBpcGVsaW5lX3N0YXR1cyxcbiAgICAgIHJlc3VsdHMsXG4gICAgICBuZXh0X3N0ZXBzOiByZXN1bHRzLnJlY29tbWVuZGF0aW9uc1xuICAgIH0pO1xuXG4gIH0gY2F0Y2ggKGVycm9yOiB1bmtub3duKSB7XG4gICAgY29uc29sZS5lcnJvcignUm9idXN0IHBpcGVsaW5lIHRlc3QgZXJyb3I6JywgZXJyb3IpO1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3Igb2NjdXJyZWQnO1xuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IFxuICAgICAgZXJyb3I6IGVycm9yTWVzc2FnZSxcbiAgICAgIG1lc3NhZ2U6ICdQaXBlbGluZSB0ZXN0IGZhaWxlZCBjb21wbGV0ZWx5J1xuICAgIH0pO1xuICB9XG59Il0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInN1cGFiYXNlIiwicHJvY2VzcyIsImVudiIsIlNVUEFCQVNFX1VSTCIsIlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwicmVzdWx0cyIsInBpcGVsaW5lX3N0YXR1cyIsInN0ZXBzIiwic2NoZW1hX2ZldGNoIiwiY2xpZW50X2dlbmVyYXRpb24iLCJlbmRfdG9fZW5kX3Rlc3QiLCJyZWNvbW1lbmRhdGlvbnMiLCJjb25zb2xlIiwibG9nIiwiZGF0YSIsInRhYmxlcyIsImVycm9yIiwicnBjIiwic3RhdHVzIiwidGFibGVzX2NvdW50IiwibGVuZ3RoIiwic2FtcGxlX3RhYmxlcyIsInNsaWNlIiwibWVzc2FnZSIsInNhbXBsZVRhYmxlIiwiY29sdW1ucyIsImNvbEVycm9yIiwidGFibGVfbmFtZV9pbnB1dCIsInNhbXBsZV9zY2hlbWEiLCJ0YWJsZSIsImNvbHVtbnNfY291bnQiLCJwdXNoIiwidGVzdE9wZXJhdGlvbnMiLCJ0ZXN0VGFibGVzIiwidGFibGVOYW1lIiwic2VsZWN0UmVzdWx0IiwiZnJvbSIsInNlbGVjdCIsImxpbWl0IiwiY291bnRSZXN1bHQiLCJjb3VudCIsImhlYWQiLCJzZWxlY3Rfc3RhdHVzIiwiY291bnRfc3RhdHVzIiwicmVjb3JkX2NvdW50Iiwic2FtcGxlX2RhdGEiLCJlcnJvcnMiLCJmaWx0ZXIiLCJCb29sZWFuIiwidGFibGVFcnJvciIsIm9wZXJhdGlvbnNfdGVzdGVkIiwid29ya2luZ190YWJsZXMiLCJvcCIsIndvcmtmbG93Iiwic2NoZW1hX2F2YWlsYWJsZSIsImNsaWVudHNfd29ya2luZyIsImdlbmVyYXRlZF9maWxlc19wYXRoIiwicmVhZHlfZm9yX3Byb2R1Y3Rpb24iLCJhbGxTdGVwc1N1Y2Nlc3MiLCJPYmplY3QiLCJ2YWx1ZXMiLCJldmVyeSIsInN0ZXAiLCJqc29uIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwib3ZlcmFsbF9zdGF0dXMiLCJuZXh0X3N0ZXBzIiwiZXJyb3JNZXNzYWdlIiwiRXJyb3IiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./pages/api/test-schema-robust.ts\n");

/***/ }),

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftest-schema-robust&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ftest-schema-robust.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();